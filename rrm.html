from flask import Flask, render_template_string, request

app = Flask(__name__)

tmpl = '''
<html>
<head><title>Simple Diet App</title></head>
<body>
<h2>Enter Details</h2>
<form method="POST">
    <input name="a" type="number" step="0.1" placeholder="Weight(kg)" required><br>
    <input name="b" type="number" step="0.1" placeholder="Height(cm)" required><br>
    <input name="c" type="number" placeholder="Age" required><br>
    <select name="d" required>
        <option value="s">Sedentary</option>
        <option value="l">Lightly active</option>
        <option value="m">Moderate</option>
        <option value="h">Active</option>
    </select><br>
    <input type="submit" value="Check">
</form>
{% if x %}
    <hr>
    <div>BMI: {{ x }}</div>
    <div>Status: {{ y }}</div>
    <div>Advice: {{ z }}</div>
{% endif %}
</body>
</html>
'''

rec = {
    'U': "Eat calorie-rich food, nuts, dairy, protein.",
    'N': "Stick to a balanced intake of grains, fruit, veg, protein.",
    'O': "Eat more fiber, protein, watch portions.",
    'B': "Lower calories. Focus on veg, fruits, grains. Skip fatty/sugary food."
}
def chk(bmi):
    if bmi < 18.5:
        return 'U'
    if bmi < 25:
        return 'N'
    if bmi < 30:
        return 'O'
    return 'B'

@app.route('/', methods=['GET','POST'])
def a():
    x, y, z = None, None, None
    if request.method == 'POST':
        w = float(request.form['a'])
        ht = float(request.form['b']) / 100
        x = round(w / (ht * ht), 2)
        y = chk(x)
        act = request.form['d']
        s = rec[y]
        if y == 'U' and act == 'h':
            z = s + " Do muscle workouts."
        elif y == 'O' and act in ['s','l']:
            z = s + " Move more."
        else:
            z = s
    return render_template_string(tmpl, x=x, y={'U':'Underweight', 'N':'Normal', 'O':'Overweight', 'B':'Obese'}[y] if y else None, z=z)

if __name__ == '__main__':
    app.run(debug=True)
